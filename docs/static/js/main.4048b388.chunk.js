(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{46:function(e,t,n){e.exports=n(94)},51:function(e,t,n){},52:function(e,t,n){},92:function(e,t,n){},94:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),i=n(13),s=n.n(i),r=(n(51),n(2)),c=n(3),l=n(5),u=n(4),d=n(1),h=n(6),v=(n(52),n(12)),f=n.n(v),p=n(19),b={DELETE:46,ENTER:13,BACKSPACE:8,ARR_UP:38,ARR_DOWN:40},k=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).save=n.save.bind(Object(d.a)(n)),n.register=n.register.bind(Object(d.a)(n)),n.selfDestroy=n.selfDestroy.bind(Object(d.a)(n)),n.mainInput=a.a.createRef(),n.__keyDown=n.__keyDown.bind(Object(d.a)(n)),n.focusNextBlock=n.focusNextBlock.bind(Object(d.a)(n)),n.focusPrevBlock=n.focusPrevBlock.bind(Object(d.a)(n)),n.onArrowUpInput=n.onArrowUpInput.bind(Object(d.a)(n)),n.onArrowDownInput=n.onArrowDownInput.bind(Object(d.a)(n)),n.keyDown=n.keyDown.bind(Object(d.a)(n)),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"register",value:function(){var e=Object(p.a)(f.a.mark(function e(){var t;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props.data?Object.assign(this.props.data,this.state.data):this.state.data,this.setState({data:t});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=this,t=this.state.data;setTimeout(function(){e.state.data===t&&e.props.save(t,e.props._id)},1e3)}},{key:"moveCursorToEnd",value:function(e){var t;if(t=e.value?e.value.length:e.innerHTML.length,console.log(t),"number"==typeof e.selectionStart)e.selectionStart=e.selectionEnd=t;else{var n=document.createRange(),o=window.getSelection(),a=e.childNodes[e.childNodes.length-1];a&&(n.setStart(a,a.length),n.collapse(!0),o.removeAllRanges(),o.addRange(n))}}},{key:"getCaretPosition",value:function(e){var t,n,o=0;if(window.getSelection)(t=window.getSelection()).rangeCount&&(n=t.getRangeAt(0)).commonAncestorContainer.parentNode===e&&(o=n.endOffset);else if(document.selection&&document.selection.createRange&&(n=document.selection.createRange()).parentElement()===e){var a=document.createElement("span");e.insertBefore(a,e.firstChild);var i=n.duplicate();i.moveToElementText(a),i.setEndPoint("EndToEnd",n),o=i.text.length}return o}},{key:"onBackspace",value:function(e){}},{key:"onArrowUp",value:function(e){}},{key:"onArrowDown",value:function(e){}},{key:"onArrowUpInput",value:function(e){0===this.getCaretPosition(e.target)&&(this.focusPrevBlock(),e.preventDefault())}},{key:"onArrowDownInput",value:function(e){this.getCaretPosition(e.target)===this.state.data.value.length&&(this.focusNextBlock("end"),e.preventDefault())}},{key:"keyDown",value:function(e){e.keyCode===b.ARR_UP&&this.onArrowUpInput(e),e.keyCode===b.ARR_DOWN&&this.onArrowDownInput(e)}},{key:"__keyDown",value:function(e){e.keyCode===b.BACKSPACE?this.onBackspace(e):e.keyCode===b.ARR_UP?this.onArrowUp(e):e.keyCode===b.ARR_DOWN&&this.onArrowDown(e)}},{key:"focusNextBlock",value:function(e){this.props.focusNext(this.props._id,e)}},{key:"focusPrevBlock",value:function(){this.props.focusPrev(this.props._id)}},{key:"componentWillMount",value:function(){this.register()}},{key:"componentDidMount",value:function(){this.props.focused&&this.props.initFocus(this.mainInput)}},{key:"selfDestroy",value:function(){this.props.selfDestroy(this.props._id,"prev")}},{key:"componentDidUpdate",value:function(e,t){t.data!==this.state.data&&this.save(),e.focused!==this.props.focused&&this.setState({focused:this.props.focused}),this.props.focused&&this.props.initFocus(this.mainInput),this.props.focused&&this.props.focusedElement&&"prev"===this.props.focusedElement.type&&this.moveCursorToEnd(this.mainInput.current)}},{key:"renderEditor",value:function(){return a.a.createElement("div",{onInput:this.saveData,style:{width:400,minHeight:200},contentEditable:!0})}},{key:"render",value:function(){return a.a.createElement("div",{onKeyDown:this.__keyDown,className:"__reacteditor block ".concat(this.state.focused?"focused":"")},a.a.createElement("div",null,this.renderEditor()))}}],[{key:"initData",get:function(){return{value:""}}},{key:"provide",get:function(){return{name:"Custom Tool",toolbox:{title:"Custom Tool"}}}}]),t}(o.Component),y=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=Object.values(this.props.config);return a.a.createElement("div",null,t.map(function(t){return a.a.createElement("div",null,"Block"!==t.config.name&&a.a.createElement("button",{onClick:function(n){e.props.addTool(t.config.name,e.props.index),e.props.destroy()},key:t.config.toolbox.title},t.config.toolbox.title,console.log(t)))}))}}]),t}(k),g=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={data:{value:""},prevPos:15},n.saveData=n.saveData.bind(Object(d.a)(n)),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"saveData",value:function(e){e.target.textContent.trim().length||(e.target.innerHTML=""),this.setState({data:{value:e.target.innerHTML}})}},{key:"onBackspace",value:function(e){""===this.state.data.value&&(e.preventDefault(),this.selfDestroy())}},{key:"renderEditor",value:function(){var e=this.props.toolSelect;return a.a.createElement("div",null,!this.state.data.value&&a.a.createElement(e,{index:this.props.index,addTool:this.props.addTool,destroy:this.selfDestroy,config:this.props.tools}),a.a.createElement("div",{onKeyDown:this.keyDown,className:"block_component",ref:this.mainInput,onInput:this.saveData,style:{width:"100%",minHeight:25},contentEditable:!0}))}}],[{key:"provide",get:function(){return{name:"Block",toolbox:{title:"Block"}}}}]),t}(k),m=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={data:{value:"",level:"1"}},n.saveData=n.saveData.bind(Object(d.a)(n)),n.changeLevel=n.changeLevel.bind(Object(d.a)(n)),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"saveData",value:function(e){e.target.textContent.trim().length||(e.target.innerHTML="");var t=e.target.innerHTML;this.setState(function(e){return{data:{value:t,level:e.data.level}}})}},{key:"onBackspace",value:function(e){""===this.state.data.value&&(e.preventDefault(),this.selfDestroy())}},{key:"changeLevel",value:function(e){var t=this.state.data;t.level=e.target.value,this.setState({data:t})}},{key:"renderEditor",value:function(){return a.a.createElement("div",null,a.a.createElement("select",{value:this.state.level,onChange:this.changeLevel},a.a.createElement("option",{value:1},"H1"),a.a.createElement("option",{value:2},"H2"),a.a.createElement("option",{value:3},"H3"),a.a.createElement("option",{value:4},"H4"),a.a.createElement("option",{value:5},"H5")),a.a.createElement("div",{onKeyDown:this.keyDown,ref:this.mainInput,className:"__reacteditor input header level--".concat(this.state.data.level),onInput:this.saveData,contentEditable:!0,html:this.state.data.value}))}}],[{key:"provide",get:function(){return{name:"Header",toolbox:{title:"Header"}}}}]),t}(k),E=n(14),w=n(45),O=n(44),j=function(e){var t=e.Block,n=e._id,o=e.index,i=(e.move,Object(O.a)(e,["Block","_id","index","move"])),s=Object(w.a)({index:o,_id:n},i);return a.a.createElement(E.b,{draggableId:n,index:o},function(e){return a.a.createElement("div",null,a.a.createElement("div",Object.assign({ref:e.innerRef},e.draggableProps,e.dragHandleProps),a.a.createElement(t,s,"123")))})},D=(n(92),n(93),function(e){function t(e){var n;Object(r.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={data:[],tools:{Block:{tool:g,config:g.provide},Header:{tool:m,config:m.provide}},toolSelect:y};var o={};return n.props.tools&&(o=n.props.tools),n.keys={},n.state.tools=Object.assign(o,n.state.tools),n.toolFocus=n.toolFocus.bind(Object(d.a)(n)),n.toolUnFocus=n.toolUnFocus.bind(Object(d.a)(n)),n.registerTool=n.registerTool.bind(Object(d.a)(n)),n.renderTool=n.renderTool.bind(Object(d.a)(n)),n.renderTools=n.renderTools.bind(Object(d.a)(n)),n.deleteTool=n.deleteTool.bind(Object(d.a)(n)),n.save=n.save.bind(Object(d.a)(n)),n.move=n.move.bind(Object(d.a)(n)),n.keyDown=n.keyDown.bind(Object(d.a)(n)),n.keyUp=n.keyUp.bind(Object(d.a)(n)),n.nextSelect=n.nextSelect.bind(Object(d.a)(n)),n.prevSelect=n.prevSelect.bind(Object(d.a)(n)),n.getIndexById=n.getIndexById.bind(Object(d.a)(n)),n.addTool=n.addTool.bind(Object(d.a)(n)),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=this.state.tools;if(this.props.tools){var n=Object.keys(this.props.tools);Object.values(this.props.tools).forEach(function(o,a){var i=e.registerTool(o,n[a]);t[i.config.name]=i})}this.setState({tools:t}),0===this.state.data.length&&this.addTool("Block")}},{key:"getIndexById",value:function(e){var t=this;return this.state.data.findIndex(function(e){return e._id===t.state.focusedElement.id})}},{key:"initFocus",value:function(e){e.current.focus()}},{key:"registerTool",value:function(e,t){var n={};return this.props.config&&this.props.config[t]?n.config=Object.assign(this.props.config[t],e.tool.provide):n.config=e.config,n.tool=e.tool,n}},{key:"toolFocus",value:function(e,t){var n=this.state.data.findIndex(function(t){return t._id===e}),o={id:e,index:n};t&&(o.type=t),-1!==n?this.setState({focusedElement:o}):this.setState({focusedElement:void 0})}},{key:"toolUnFocus",value:function(e){this.setState({focusedElement:void 0})}},{key:"renderTool",value:function(e,t){var n=this,o=e.tool,i=!1;return this.state.focusedElement&&this.state.focusedElement.index===t&&(i=!0),a.a.createElement("div",{key:e._id,onBlur:this.toolUnFocus,onFocus:function(t){return n.toolFocus(e._id)}},a.a.createElement(j,Object.assign({Block:o,key:e._id,_id:e._id,save:this.save,move:this.move,index:t,addTool:this.addTool},e.config,{focused:i,initFocus:this.initFocus,selfDestroy:this.deleteTool,focusNext:this.nextSelect,focusPrev:this.prevSelect,focusedElement:this.state.focusedElement,toolSelect:this.state.toolSelect,tools:this.state.tools,config:this.state.tools[e.block].config})))}},{key:"nextSelect",value:function(e,t){var n=this.state.data,o={};e?o.index=this.getIndexById(e):o=this.state.focusedElement,o&&(o.index>=n.length-1||(this.toolFocus(n[o.index+1]._id,"next"),this.setState({data:n})))}},{key:"prevSelect",value:function(e){var t=this.state.data,n={};e?n.index=this.getIndexById(e):n=this.state.focusedElement,n&&0!==n.index&&this.toolFocus(t[n.index-1]._id,"prev")}},{key:"renderTools",value:function(){var e=this;return this.state.data.map(function(t,n){return e.renderTool(t,n)})}},{key:"addTool",value:function(){var e=Object(p.a)(f.a.mark(function e(t,n,o){var a,i;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.state.data,i={tool:this.state.tools[t].tool,block:t,data:{},_id:(Date.now().toString(36)+Math.random().toString(36).substr(2,11)).toLowerCase(),tabindex:a.length},void 0===n||-1===n?a.push(i):a.splice(n+1,0,i),e.next=5,this.setState({data:a});case 5:return"silent"!==o&&this.toolFocus(i._id),e.abrupt("return",i._id);case 7:case"end":return e.stop()}},e,this)}));return function(t,n,o){return e.apply(this,arguments)}}()},{key:"deleteTool",value:function(e,t){var n=this.state.data,o=n.findIndex(function(t){return t._id===e});n.splice(o,1);var a=n[o-1];a&&this.toolFocus(a._id,t),this.setState({data:n})}},{key:"save",value:function(e,t){var n=this.state.data;n.forEach(function(o,a){o._id===t&&(n[a].data=e)}),this.setState({data:n})}},{key:"componentDidUpdate",value:function(){console.log(this.state),0===this.state.data.length&&this.addTool("Block");var e=this.state.focusedElement;e&&e.type&&(delete e.type,this.setState({focusedElement:e}))}},{key:"keyUp",value:function(e){this.keys[e.keyCode]=!1}},{key:"keyDown",value:function(e){var t=this;if(this.keys[e.keyCode]=!0,e.keyCode===b.DELETE){if(e.preventDefault(),!this.state.focusedElement)return;var n=this.state.data,o=n.findIndex(function(e){return e._id===t.state.focusedElement.id});n.splice(o,1),this.prevSelect(),this.setState({data:n})}if(e.keyCode===b.ENTER){e.preventDefault(),o=this.state.focusedElement?this.state.focusedElement.index:-1;this.addTool("Block",o);this.nextSelect()}}},{key:"move",value:function(e){var t=e.destination,n=e.source,o=e.draggableId;if(t&&(t.droppableId!==n.droppableId||t.index!==n.index)){var a=this.state.data,i=a[n.index];a.splice(n.index,1),a.splice(t.index,0,i),this.setState({data:a}),this.toolFocus(o)}}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"__reacteditor core mini",onKeyDown:this.keyDown,onKeyUp:this.keyUp},a.a.createElement(E.a,{onDragEnd:this.move},a.a.createElement(E.c,{droppableId:"workspace"},function(t){return a.a.createElement("div",Object.assign({ref:t.innerRef},t.droppableProps,{style:{marginBottom:"200px"}}),e.renderTools())})))}}]),t}(o.Component)),x=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={data:{}},n.updateData=n.updateData.bind(Object(d.a)(n)),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"updateData",value:function(){}},{key:"render",value:function(){return a.a.createElement("div",{style:{padding:"0 5%"}},a.a.createElement(D,{onUpdate:this.updateData}))}}]),t}(o.Component),T=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function _(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}s.a.render(a.a.createElement(x,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");T?(function(e,t){fetch(e).then(function(n){var o=n.headers.get("content-type");404===n.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):_(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):_(t,e)})}}()}},[[46,1,2]]]);
//# sourceMappingURL=main.4048b388.chunk.js.map