{"version":3,"sources":["tools/core/core/keys.js","tools/core/tools/customTool.js","tools/core/tools/toolSelect.js","tools/core/tools/block.js","tools/core/tools/header.js","tools/core/tools/blockDraggable.js","tools/core/core/editor.js","App.js","serviceWorker.js","index.js"],"names":["keys","DELETE","ENTER","BACKSPACE","ARR_UP","ARR_DOWN","BlockComponent","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","save","bind","assertThisInitialized","register","selfDestroy","mainInput","React","createRef","__keyDown","focusNextBlock","focusPrevBlock","onArrowUpInput","onArrowDownInput","keyDown","data","assign","state","setState","_this2","setTimeout","_id","el","value","length","innerHTML","console","log","selectionStart","selectionEnd","range","document","createRange","sel","window","getSelection","lastChild","childNodes","setStart","collapse","removeAllRanges","addRange","editableDiv","caretPos","rangeCount","getRangeAt","commonAncestorContainer","parentNode","endOffset","selection","parentElement","tempEl","createElement","insertBefore","firstChild","tempRange","duplicate","moveToElementText","setEndPoint","text","e","getCaretPosition","target","preventDefault","keyCode","onBackspace","onArrowUp","onArrowDown","to","focusNext","focusPrev","focused","initFocus","prevProps","prevState","focusedElement","type","moveCursorToEnd","current","react_default","a","onInput","saveData","style","width","minHeight","contentEditable","onKeyDown","className","concat","renderEditor","name","toolbox","title","Component","ToolSelect","conf","values","config","map","item","onClick","addTool","index","destroy","key","Block","prevPos","textContent","trim","toolSelect","tools","ref","Header","level","changeLevel","onChange","html","BlockDraggable","_ref","restProps","move","objectWithoutProperties","propsToSend","objectSpread","react_beautiful_dnd_esm","draggableId","provided","innerRef","draggableProps","dragHandleProps","ReactEditor","require","tool","provide","toolFocus","toolUnFocus","registerTool","renderTool","renderTools","deleteTool","keyUp","nextSelect","prevSelect","getIndexById","forEach","r_tool","id","_this3","findIndex","focus","undefined","_this4","ToolComponent","onBlur","onFocus","blockDraggable","block","_this5","mode","list","toolToPush","Date","now","toString","Math","random","substr","toLowerCase","tabindex","push","splice","elemBefore","curData","_this6","result","destination","source","droppableId","workspace","sourceData","_this7","onKeyUp","onDragEnd","droppableProps","marginBottom","App","updateData","padding","core_editor","onUpdate","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","navigator","serviceWorker","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onSuccess","catch","error","ReactDOM","render","src_App_0","getElementById","URL","process","href","origin","addEventListener","fetch","response","contentType","headers","get","status","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.4048b388.chunk.js","sourcesContent":["const keys = {\r\n\t'DELETE': 46,\r\n\t'ENTER' : 13,\r\n\t'BACKSPACE': 8,\r\n\t'ARR_UP': 38,\r\n\t'ARR_DOWN': 40\r\n}\r\n\r\nexport default keys;\r\n","import React, { Component } from 'react';\r\nimport keys from '../core/keys';\r\n\r\nclass BlockComponent extends Component {\r\n  constructor(props){\r\n      super(props);\r\n\t\t\tthis.save = this.save.bind(this);\r\n\t\t\tthis.register = this.register.bind(this);\r\n      this.selfDestroy = this.selfDestroy.bind(this);\r\n      this.mainInput = React.createRef();\r\n      this.__keyDown = this.__keyDown.bind(this);\r\n      this.focusNextBlock = this.focusNextBlock.bind(this);\r\n      this.focusPrevBlock = this.focusPrevBlock.bind(this);\r\n      this.onArrowUpInput = this.onArrowUpInput.bind(this);\r\n      this.onArrowDownInput = this.onArrowDownInput.bind(this);\r\n      this.keyDown = this.keyDown.bind(this);\r\n  }\r\n\r\n  static get initData(){\r\n    return {value: ''};\r\n  }\r\n\r\n  static get provide(){\r\n    return {\r\n      name: 'Custom Tool',\r\n      toolbox: {\r\n        title: 'Custom Tool'\r\n      }\r\n    };\r\n  }\r\n\r\n\tasync register(){\r\n    var data;\r\n    if(this.props.data) data = Object.assign(this.props.data, this.state.data);\r\n    else data = this.state.data;\r\n\t\tthis.setState({data: data});\r\n\t}\r\n\r\n\tsave() {\r\n\t\tvar data = this.state.data;\r\n\t\tsetTimeout(() => {\r\n\t\t\tif (this.state.data === data){\r\n\t\t\t\tthis.props.save(data, this.props._id);\r\n\t\t\t}\r\n\t\t}, 1000);\r\n\t}\r\n\r\n  moveCursorToEnd(el) {\r\n    var value;\r\n    if(el.value) value = el.value.length;\r\n    else value= el.innerHTML.length;\r\n    console.log(value);\r\n    if (typeof el.selectionStart == \"number\") {\r\n        el.selectionStart = el.selectionEnd = value;\r\n    }\r\n    else {\r\n      var range = document.createRange();\r\n      var sel = window.getSelection();\r\n      var lastChild = el.childNodes[el.childNodes.length-1];\r\n      if(lastChild){\r\n        range.setStart(lastChild, lastChild.length);\r\n        range.collapse(true);\r\n        sel.removeAllRanges();\r\n        sel.addRange(range);\r\n      }\r\n    }\r\n}\r\n\r\n  getCaretPosition(editableDiv) {\r\n    var caretPos = 0,\r\n      sel, range;\r\n    if (window.getSelection) {\r\n      sel = window.getSelection();\r\n      if (sel.rangeCount) {\r\n        range = sel.getRangeAt(0);\r\n        if (range.commonAncestorContainer.parentNode === editableDiv) {\r\n          caretPos = range.endOffset;\r\n        }\r\n      }\r\n    } else if (document.selection && document.selection.createRange) {\r\n      range = document.selection.createRange();\r\n      if (range.parentElement() === editableDiv) {\r\n        var tempEl = document.createElement(\"span\");\r\n        editableDiv.insertBefore(tempEl, editableDiv.firstChild);\r\n        var tempRange = range.duplicate();\r\n        tempRange.moveToElementText(tempEl);\r\n        tempRange.setEndPoint(\"EndToEnd\", range);\r\n        caretPos = tempRange.text.length;\r\n      }\r\n    }\r\n    return caretPos;\r\n  }\r\n\r\n  onBackspace(e){\r\n    return;\r\n  }\r\n\r\n  onArrowUp(e){\r\n    return;\r\n  }\r\n\r\n  onArrowDown(e){\r\n    return;\r\n  }\r\n\r\n  onArrowUpInput(e){\r\n    var pos = this.getCaretPosition(e.target);\r\n    if(pos === 0){\r\n      this.focusPrevBlock();\r\n      e.preventDefault();\r\n    }\r\n  }\r\n\r\n  onArrowDownInput(e){\r\n    var pos = this.getCaretPosition(e.target);\r\n    if(pos === this.state.data.value.length){\r\n      this.focusNextBlock('end');\r\n      e.preventDefault();\r\n    }\r\n  }\r\n\r\n  keyDown(e){\r\n    if(e.keyCode === keys['ARR_UP']) {\r\n      this.onArrowUpInput(e);\r\n    }\r\n    if(e.keyCode === keys['ARR_DOWN']) {\r\n      this.onArrowDownInput(e);\r\n    }\r\n  }\r\n\r\n  __keyDown(e){\r\n    if(e.keyCode === keys['BACKSPACE']) {\r\n      this.onBackspace(e);\r\n    }\r\n    else if(e.keyCode === keys['ARR_UP']) {\r\n      this.onArrowUp(e);\r\n    }\r\n    else if(e.keyCode === keys['ARR_DOWN']) {\r\n      this.onArrowDown(e);\r\n    }\r\n  }\r\n\r\n  focusNextBlock(to){\r\n    this.props.focusNext(this.props._id, to);\r\n  }\r\n\r\n  focusPrevBlock(){\r\n    this.props.focusPrev(this.props._id);\r\n  }\r\n\r\n\tcomponentWillMount(){\r\n\t\tthis.register();\r\n\t}\r\n\r\n  componentDidMount(){\r\n    if(this.props.focused) this.props.initFocus(this.mainInput);\r\n  }\r\n\r\n  selfDestroy(){\r\n    this.props.selfDestroy(this.props._id, 'prev');\r\n  }\r\n\r\n\tcomponentDidUpdate(prevProps, prevState){\r\n\t\tif(prevState.data !== this.state.data){\r\n\t\t\tthis.save();\r\n\t\t}\r\n    if(prevProps.focused !== this.props.focused) this.setState({focused: this.props.focused});\r\n    if(this.props.focused) this.props.initFocus(this.mainInput);\r\n    if(\r\n      this.props.focused &&\r\n      this.props.focusedElement &&\r\n      this.props.focusedElement.type === 'prev'\r\n    ) this.moveCursorToEnd(this.mainInput.current);\r\n\t}\r\n\r\n  renderEditor(){\r\n    return (\r\n        <div onInput={this.saveData} style={{width: 400, minHeight: 200}} contentEditable />\r\n    );\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div onKeyDown={this.__keyDown} className={`__reacteditor block ${this.state.focused ? 'focused' : ''}`}>\r\n        <div>\r\n        {this.renderEditor()}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n}\r\n\r\nexport default BlockComponent;\r\n","import React, { Component } from 'react';\r\nimport BlockComponent from './customTool';\r\n\r\nclass ToolSelect extends BlockComponent {\r\n  constructor(props){\r\n      super(props);\r\n      this.state = {\r\n      }\r\n  }\r\n\trender(){\r\n\t\tvar conf = Object.values(this.props.config);\r\n\t\treturn(\r\n\t\t\t<div>\r\n\t\t\t{\r\n\t\t\t\tconf.map(item => {\r\n\t\t\t\t\treturn(\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t{ item.config.name !== 'Block' &&\r\n\t\t\t\t\t\t\t<button onClick={(e)=> {this.props.addTool(item.config.name, this.props.index); this.props.destroy()}} key={item.config.toolbox.title}>\r\n\t\t\t\t\t\t\t\t{item.config.toolbox.title}\r\n\t\t\t\t\t\t\t\t{console.log(item)}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default ToolSelect;\r\n","import React, { Component } from 'react';\r\nimport BlockComponent from './customTool';\r\nimport keys from '../core/keys';\r\n\r\nclass Block extends BlockComponent {\r\n  constructor(props){\r\n      super(props);\r\n      this.state = {\r\n        data: {\r\n          value: '',\r\n        },\r\n        prevPos: 15\r\n      }\r\n\t\t\tthis.saveData = this.saveData.bind(this);\r\n  }\r\n\r\n\tsaveData(e){\r\n\t\tif (!e.target.textContent.trim().length) {\r\n      e.target.innerHTML = '';\r\n    }\r\n\t\tthis.setState({data: {value: e.target.innerHTML }});\r\n\t}\r\n\r\n  onBackspace(e){\r\n    if(this.state.data.value === ''){\r\n      e.preventDefault();\r\n      this.selfDestroy();\r\n    }\r\n  }\r\n\r\n\tstatic get provide(){\r\n    return {\r\n\t\t\tname: 'Block',\r\n\t\t\ttoolbox: {\r\n\t\t\t\ttitle: 'Block'\r\n\t\t\t}\r\n    };\r\n  }\r\n\r\n  renderEditor(){\r\n    var ToolSelect = this.props.toolSelect;\r\n    return (\r\n        <div>\r\n          {!this.state.data.value &&<ToolSelect index={this.props.index} addTool={this.props.addTool} destroy={this.selfDestroy} config={this.props.tools}/>}\r\n          <div onKeyDown={this.keyDown} className=\"block_component\" ref={this.mainInput} onInput={this.saveData} style={{width: '100%', minHeight: 25}} contentEditable />\r\n        </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Block;\r\n","import React, { Component } from 'react';\r\nimport BlockComponent from './customTool';\r\nimport keys from '../core/keys';\r\n\r\nclass Header extends BlockComponent {\r\n  constructor(props){\r\n      super(props);\r\n      this.state = {\r\n        data: {\r\n          value: '',\r\n          level: '1'\r\n        }\r\n      }\r\n\t\t\tthis.saveData = this.saveData.bind(this);\r\n      this.changeLevel = this.changeLevel.bind(this);\r\n  }\r\n\r\n  static get provide(){\r\n    return {\r\n      name: 'Header',\r\n      toolbox: {\r\n        title: 'Header'\r\n      }\r\n    };\r\n  }\r\n\r\n\tsaveData(e){\r\n\t\tif (!e.target.textContent.trim().length) {\r\n      e.target.innerHTML = '';\r\n    }\r\n    var value = e.target.innerHTML;\r\n    this.setState(prevState => ({\r\n      data: {\r\n        value: value,\r\n        level: prevState.data.level\r\n      }\r\n    }));\r\n\t}\r\n\r\n  onBackspace(e){\r\n    if(this.state.data.value === ''){\r\n      e.preventDefault();\r\n      this.selfDestroy();\r\n    }\r\n  }\r\n\r\n  changeLevel(e){\r\n    var data = this.state.data;\r\n    data.level = e.target.value;\r\n    this.setState({data});\r\n  }\r\n\r\n  renderEditor(){\r\n    return (\r\n        <div>\r\n        <select value={this.state.level} onChange={this.changeLevel}>\r\n          <option value={1}>H1</option>\r\n          <option value={2}>H2</option>\r\n          <option value={3}>H3</option>\r\n          <option value={4}>H4</option>\r\n          <option value={5}>H5</option>\r\n        </select>\r\n        <div onKeyDown={this.keyDown} ref={this.mainInput} className={`__reacteditor input header level--${this.state.data.level}`} onInput={this.saveData} contentEditable html={this.state.data.value} />\r\n        </div>\r\n    );\r\n  }\r\n\r\n}\r\n\r\nexport default Header;\r\n","import React, { useRef } from 'react'\r\nimport { Draggable } from 'react-beautiful-dnd';\r\n\r\nconst BlockDraggable = ({ Block, _id, index, move, ...restProps }) => {\r\n\r\n  var propsToSend = {\r\n    index,\r\n    _id,\r\n    ...restProps\r\n  };\r\n  return (\r\n    <Draggable draggableId={_id} index={index}>\r\n    {(provided)=>\r\n      <div>\r\n        <div ref={provided.innerRef} {...provided.draggableProps} {...provided.dragHandleProps}>\r\n          <Block { ...propsToSend }>\r\n            123\r\n          </Block>\r\n        </div>\r\n      </div>\r\n    }\r\n    </Draggable>\r\n  )\r\n}\r\nexport default BlockDraggable\r\n","import React, { Component } from 'react';\r\nimport ToolSelect from '../tools/toolSelect';\r\nimport Block from '../tools/block';\r\nimport Header from '../tools/header';\r\nimport keys from './keys';\r\nimport { DragDropContext, Droppable } from 'react-beautiful-dnd';\r\nimport BlockDraggable from '../tools/blockDraggable';\r\nimport ReactDOM from 'react-dom';\r\nimport '../styles/editor.css'\r\n\r\nconst update = require('immutability-helper');\r\n\r\nclass ReactEditor extends Component {\r\n  constructor(props){\r\n      super(props);\r\n      this.state = {\r\n        data: [],\r\n\t\t\t\ttools: {\r\n\t\t\t\t\t'Block': {\r\n\t\t\t\t\t\ttool: Block,\r\n            config: Block.provide\r\n\t\t\t\t\t},\r\n\t\t\t\t\t'Header': {\r\n\t\t\t\t\t\ttool: Header,\r\n            config: Header.provide\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n        toolSelect: ToolSelect,\r\n      }\r\n\t\t\tvar tools = {};\r\n\r\n\t\t\tif(this.props.tools) tools = this.props.tools;\r\n\r\n      this.keys = {};\r\n\t\t\tthis.state.tools = Object.assign(tools, this.state.tools);\r\n      this.toolFocus = this.toolFocus.bind(this);\r\n      this.toolUnFocus = this.toolUnFocus.bind(this);\r\n\t\t\tthis.registerTool = this.registerTool.bind(this);\r\n\t\t\tthis.renderTool = this.renderTool.bind(this);\r\n\t\t\tthis.renderTools = this.renderTools.bind(this);\r\n      this.deleteTool = this.deleteTool.bind(this);\r\n\t\t\tthis.save = this.save.bind(this);\r\n      this.move = this.move.bind(this);\r\n      this.keyDown = this.keyDown.bind(this);\r\n      this.keyUp = this.keyUp.bind(this);\r\n      this.nextSelect = this.nextSelect.bind(this);\r\n      this.prevSelect = this.prevSelect.bind(this);\r\n      this.getIndexById = this.getIndexById.bind(this);\r\n      this.addTool = this.addTool.bind(this);\r\n  }\r\n\r\n\tcomponentWillMount(){\r\n\t\tvar tools = this.state.tools;\r\n\t\tif(this.props.tools){\r\n      var keys = Object.keys(this.props.tools);\r\n      var arr = Object.values(this.props.tools);\r\n\t\t\tarr.forEach((tool, index) => {\r\n\t\t\t\tvar r_tool = this.registerTool(tool, keys[index]);\r\n\t\t\t\ttools[r_tool.config.name] = r_tool;\r\n\t\t\t});\r\n\t\t}\r\n    this.setState({tools: tools});\r\n    if(this.state.data.length === 0) this.addTool('Block');\r\n\t}\r\n\r\n  getIndexById(id){\r\n    var data = this.state.data;\r\n    return data.findIndex(item =>{\r\n      return item._id === this.state.focusedElement.id;\r\n    });\r\n  }\r\n\r\n  initFocus(ref){\r\n    ref.current.focus();\r\n  }\r\n\r\n\tregisterTool(tool, name){\r\n    let data = {};\r\n    if(this.props.config && this.props.config[name]){\r\n      data.config = Object.assign(this.props.config[name], tool.tool.provide);\r\n    }\r\n    else data.config = tool.config;\r\n\t\tdata.tool = tool.tool;\r\n\t\treturn data;\r\n\t}\r\n\r\n  toolFocus(id, type){\r\n    var data = this.state.data;\r\n    var index = data.findIndex(item =>{\r\n      return item._id === id;\r\n    });\r\n    var item = {\r\n      id: id,\r\n      index: index\r\n    };\r\n    if(type) item.type = type;\r\n    if(index !== -1){\r\n      this.setState({focusedElement: item})\r\n    }\r\n    else this.setState({focusedElement: undefined});\r\n  }\r\n\r\n  toolUnFocus(e){\r\n    this.setState({focusedElement: undefined})\r\n  }\r\n\r\n\trenderTool(tool, index){\r\n\t\tvar ToolComponent = tool.tool;\r\n    var focused = false;\r\n    if(this.state.focusedElement && this.state.focusedElement.index === index) focused = true;\r\n\t\treturn (\r\n      <div\r\n        key={ tool._id }\r\n        onBlur={this.toolUnFocus}\r\n        onFocus={(e) => this.toolFocus(tool._id)}\r\n      >\r\n        <BlockDraggable\r\n          Block={ToolComponent}\r\n          key={ tool._id }\r\n          _id={ tool._id }\r\n          save={ this.save }\r\n          move={ this.move }\r\n          index={ index }\r\n          addTool={ this.addTool }\r\n          { ...tool.config }\r\n          focused={ focused }\r\n          initFocus={ this.initFocus }\r\n          selfDestroy={ this.deleteTool }\r\n          focusNext={this.nextSelect}\r\n          focusPrev={this.prevSelect}\r\n          focusedElement={this.state.focusedElement}\r\n          toolSelect={this.state.toolSelect}\r\n          tools={this.state.tools}\r\n          config={this.state.tools[tool.block].config}\r\n        />\r\n      </div>\r\n    );\r\n\t}\r\n\r\n  nextSelect(id, to){\r\n    var data = this.state.data;\r\n    var focusedElement = {};\r\n    if(!id) focusedElement = this.state.focusedElement;\r\n    else{\r\n      focusedElement.index = this.getIndexById(id);\r\n    }\r\n    if(!focusedElement) return;\r\n    if(focusedElement.index >= data.length-1) return;\r\n    this.toolFocus(data[focusedElement.index+1]._id, 'next');\r\n    this.setState({data});\r\n  }\r\n\r\n  prevSelect(id){\r\n    var data = this.state.data;\r\n    var focusedElement = {};\r\n    if(!id) focusedElement = this.state.focusedElement;\r\n    else{\r\n      focusedElement.index = this.getIndexById(id);\r\n    }\r\n    if(!focusedElement) return;\r\n    if(focusedElement.index === 0) return;\r\n    this.toolFocus(data[focusedElement.index-1]._id, 'prev');\r\n  }\r\n\r\n\trenderTools(){\r\n\t\treturn this.state.data.map((tool, index) => {\r\n\t\t\treturn this.renderTool(tool, index);\r\n\t\t});\r\n\t}\r\n\r\n\tasync addTool(name, index, mode){\r\n\t\tvar list = this.state.data;\r\n\r\n\t\tvar toolToPush = {\r\n\t\t\ttool: this.state.tools[name].tool,\r\n\t\t\tblock: name,\r\n\t\t\tdata: {},\r\n\t\t\t_id: (Date.now().toString(36) + Math.random().toString(36).substr(2, 11)).toLowerCase(),\r\n      tabindex: list.length\r\n\t\t};\r\n\r\n    if(index === undefined || index === -1) list.push(toolToPush);\r\n    else list.splice(index+1, 0, toolToPush);\r\n\t\tawait this.setState({data: list});\r\n    if( mode !== 'silent') this.toolFocus(toolToPush._id);\r\n    return toolToPush._id;\r\n\t}\r\n\r\n  deleteTool(id, type){\r\n    var data = this.state.data;\r\n    var index = data.findIndex(item =>{\r\n      return item._id === id;\r\n    });\r\n    data.splice(index, 1);\r\n    var elemBefore = data[index-1];\r\n    if(elemBefore) this.toolFocus(elemBefore._id, type);\r\n    this.setState({data: data});\r\n  }\r\n\r\n\tsave(data, id){\r\n\t\tvar curData = this.state.data;\r\n\t\tcurData.forEach((item, index) => {\r\n\t\t\tif (item._id === id) curData[index].data = data;\r\n\t\t});\r\n\t\tthis.setState({data: curData});\r\n\t}\r\n\r\n\tcomponentDidUpdate(){\r\n\t\tconsole.log(this.state);\r\n    if(this.state.data.length === 0) this.addTool('Block');\r\n    var focusedElement = this.state.focusedElement;\r\n    if(focusedElement && focusedElement.type){\r\n      delete focusedElement.type;\r\n      this.setState({focusedElement: focusedElement});\r\n    }\r\n\t}\r\n\r\n  keyUp(e){\r\n    this.keys[e.keyCode] = false;\r\n  }\r\n\r\n  keyDown(e){\r\n    this.keys[e.keyCode] = true;\r\n    if(e.keyCode === keys['DELETE']) {\r\n      e.preventDefault();\r\n      if(!this.state.focusedElement) return;\r\n      var data = this.state.data;\r\n      var index = data.findIndex(item =>{\r\n        return item._id === this.state.focusedElement.id;\r\n      });\r\n      data.splice(index, 1);\r\n      this.prevSelect();\r\n      this.setState({data: data});\r\n    }\r\n\r\n    if(e.keyCode === keys['ENTER']) {\r\n      e.preventDefault();\r\n      var index;\r\n      if(this.state.focusedElement) index = this.state.focusedElement.index;\r\n      else index = -1;\r\n      var id = this.addTool('Block', index);\r\n      this.nextSelect();\r\n    }\r\n  }\r\n\r\n  move(result){\r\n    const { destination, source, draggableId } = result;\r\n    if(!destination) return;\r\n    if(\r\n        destination.droppableId === source.droppableId &&\r\n        destination.index === source.index\r\n      ){\r\n        return;\r\n    }\r\n    var workspace = this.state.data;\r\n    var sourceData = workspace[source.index];\r\n    workspace.splice(source.index, 1);\r\n    workspace.splice(destination.index, 0, sourceData);\r\n    this.setState({data: workspace});\r\n    this.toolFocus(draggableId);\r\n  }\r\n\r\n  render(){\r\n    return (\r\n        <div className=\"__reacteditor core mini\" onKeyDown={this.keyDown} onKeyUp={this.keyUp}>\r\n          <DragDropContext onDragEnd={this.move}>\r\n            <Droppable droppableId=\"workspace\">\r\n              {provided=> (\r\n                <div\r\n                  ref={provided.innerRef}\r\n                  {...provided.droppableProps}\r\n                  style={{marginBottom: '200px'}}\r\n                >\r\n                {this.renderTools()}\r\n                </div>\r\n              )}\r\n            </Droppable>\r\n          </DragDropContext>\r\n        </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ReactEditor;\r\n","import React, { Component } from 'react';\nimport './App.css';\nimport ReactEditor from './tools/core/core/editor'\n\nclass App extends Component {\n  constructor(props){\n      super(props);\n      this.state = {\n        data: {}\n      }\n      this.updateData = this.updateData.bind(this);\n  }\n\n  updateData(){\n\n  }\n\n  render(){\n    return (\n        <div style={{padding: '0 5%'}}>\n          <ReactEditor\n            onUpdate={this.updateData}\n          />\n        </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n"],"sourceRoot":""}